# ğŸš€ å¤§æ¨¡å‹é›†è®­è¥ - ä»åŸºç¡€åˆ°å®æˆ˜çš„å®Œæ•´å­¦ä¹ è·¯å¾„

è¿™æ˜¯ä¸€ä¸ªä¸“ä¸ºå¤§æ¨¡å‹å¼€å‘è€…è®¾è®¡çš„äºŒå¤©é›†è®­è¥é¡¹ç›®ï¼Œæ¶µç›–äº†ä»åŸºç¡€èŠå¤©æœºå™¨äººåˆ°é«˜çº§ MCPï¼ˆModel Context Protocolï¼‰å¼€å‘ï¼Œæœ€ç»ˆå®ç°å®‰å…¨å®¡è®¡å·¥å…·çš„å®Œæ•´å­¦ä¹ è·¯å¾„ã€‚

## ğŸ“š è¯¾ç¨‹æ¦‚è§ˆ

```
å¤§æ¨¡å‹ --> Agent --> Function Calling --> MCP --> å®‰å…¨å®¡è®¡å·¥å…·
```

æœ¬é›†è®­è¥é‡‡ç”¨æ¸è¿›å¼å­¦ä¹ æ–¹æ³•ï¼Œä»æœ€åŸºç¡€çš„èŠå¤©æœºå™¨äººå¼€å§‹ï¼Œé€æ­¥æ·±å…¥åˆ° Function Callingã€MCP åè®®ï¼Œæœ€ç»ˆæ„å»ºä¸€ä¸ªä¸“ä¸šçš„å®‰å…¨å®¡è®¡å·¥å…·ã€‚

## ğŸ¯ å­¦ä¹ ç›®æ ‡

- **æŒæ¡å¤§æ¨¡å‹ API è°ƒç”¨**ï¼šå­¦ä¼šä½¿ç”¨ DeepSeek ç­‰å¤§æ¨¡å‹ API
- **ç†è§£ Function Calling**ï¼šæŒæ¡å‡½æ•°è°ƒç”¨æœºåˆ¶å’Œå®æ—¶ä¿¡æ¯è·å–
- **æ·±å…¥ MCP åè®®**ï¼šç†è§£ Model Context Protocol çš„åŸç†å’Œåº”ç”¨
- **æ„å»ºå®æˆ˜å·¥å…·**ï¼šå¼€å‘ä¸“ä¸šçš„ä¾èµ–å®‰å…¨å®¡è®¡å·¥å…·

## ğŸ“‹ é¡¹ç›®ç»“æ„

### 01. èŠå¤©æœºå™¨äºº

**åŸºç¡€èŠå¤©æœºå™¨äººå®ç°**

- **å‰ç«¯**ï¼šVue.js èŠå¤©ç•Œé¢
- **åç«¯**ï¼šExpress.js æœåŠ¡å™¨
- **åŠŸèƒ½**ï¼šåŸºç¡€çš„é—®ç­”å¯¹è¯
- **æŠ€æœ¯æ ˆ**ï¼šVue 3 + Express + DeepSeek API

```javascript
// åŸºç¡€ API è°ƒç”¨ç¤ºä¾‹
const response = await fetch('https://api.deepseek.com/chat/completions', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    Authorization: `Bearer ${API_KEY}`,
  },
  body: JSON.stringify({
    model: 'deepseek-chat',
    messages: [{ role: 'user', content: userMessage }],
  }),
})
```

### 02. å¸¦ä¸Šä¸‹æ–‡çš„èŠå¤©æœºå™¨äºº

**å¢å¼ºä¸Šä¸‹æ–‡è®°å¿†åŠŸèƒ½**

- **æ ¸å¿ƒæ”¹è¿›**ï¼šå®ç°å¯¹è¯å†å²è®°å½•
- **æŠ€æœ¯è¦ç‚¹**ï¼šæ¶ˆæ¯å†å²ç®¡ç†ã€ä¸Šä¸‹æ–‡ä¼ é€’
- **ç”¨æˆ·ä½“éªŒ**ï¼šè¿ç»­å¯¹è¯ä½“éªŒæå‡

### 03. èŠå¤©æœºå™¨äººè·å–å®æ—¶ä¿¡æ¯

**é›†æˆå®æ—¶ä¿¡æ¯è·å–èƒ½åŠ›**

- **æ–°å¢åŠŸèƒ½**ï¼šå¤©æ°”ä¿¡æ¯æŸ¥è¯¢
- **API é›†æˆ**ï¼šå’Œé£å¤©æ°” API
- **æŠ€æœ¯å®ç°**ï¼š
  - åŸå¸‚ä½ç½®è§£æ
  - å¤©æ°”æ•°æ®è·å–
  - æ—¥æœŸæ ¼å¼åŒ–å¤„ç†

```javascript
// å¤©æ°”ä¿¡æ¯è·å–ç¤ºä¾‹
async function getWeather(city, dateText) {
  const location = await getCityLocation(city)
  const date = formatDate(dateText)
  // è°ƒç”¨å¤©æ°” API
  const weather = await fetchWeatherData(location, date)
  return weather
}
```

### 04. FunctionCalling ç‰ˆæœ¬èŠå¤©æœºå™¨äºº

**å®ç° Function Calling æœºåˆ¶**

- **æ ¸å¿ƒæŠ€æœ¯**ï¼šFunction Calling
- **åŠŸèƒ½å¢å¼º**ï¼šæ™ºèƒ½å‡½æ•°è°ƒç”¨
- **ä½¿ç”¨åœºæ™¯**ï¼š
  - å¤©æ°”æŸ¥è¯¢
  - æ•°æ®å¤„ç†
  - å·¥å…·è°ƒç”¨

### 05. weather-mcp-server

**å¤©æ°” MCP æœåŠ¡å™¨å®ç°**

- **åè®®**ï¼šModel Context Protocol
- **æ¶æ„**ï¼šTypeScript + MCP SDK
- **åŠŸèƒ½**ï¼šæä¾›å¤©æ°”æŸ¥è¯¢ MCP å·¥å…·

```typescript
// MCP æœåŠ¡å™¨å¯åŠ¨
import { StdioServerTransport } from '@modelcontextprotocol/sdk/server/stdio.js'
import { server } from './server.js'

async function main() {
  const transport = new StdioServerTransport()
  await server.connect(transport)
  console.error('å¤©æ°”æœåŠ¡å™¨å·²å¯åŠ¨')
}
```

### 06. mcp-client

**MCP å®¢æˆ·ç«¯å®ç°**

- **åŠŸèƒ½**ï¼šå¤š MCP æœåŠ¡å™¨ç®¡ç†
- **ç‰¹æ€§**ï¼š
  - åŠ¨æ€é…ç½®åŠ è½½
  - å·¥å…·æ˜ å°„ç®¡ç†
  - æœåŠ¡å™¨çŠ¶æ€ç›‘æ§

```javascript
// MCP å®¢æˆ·ç«¯ç®¡ç†å™¨
class MCPServerManager {
  constructor() {
    this.mcpServers = new Map()
    this.toolServerMap = new Map()
  }

  async callMCPTool(toolName, args) {
    const serverName = this.toolServerMap.get(toolName)
    // è°ƒç”¨å¯¹åº”çš„ MCP æœåŠ¡å™¨å·¥å…·
  }
}
```

## ğŸ›¡ï¸ 07. å®‰å…¨å®¡è®¡å·¥å…· - æ ¸å¿ƒå®æˆ˜é¡¹ç›®

### é¡¹ç›®æ¦‚è¿°

**Check Dependency** æ˜¯ä¸€ä¸ªåŸºäº MCP åè®®çš„ä¸“ä¸š Node.js ä¾èµ–å®‰å…¨å®¡è®¡å·¥å…·ï¼Œä¸“ä¸ºç°ä»£ AI å¼€å‘ç¯å¢ƒè®¾è®¡ã€‚è¯¥å·¥å…·é€šè¿‡è°ƒç”¨ npm å®˜æ–¹å®‰å…¨å®¡è®¡ APIï¼Œèƒ½å¤Ÿå¿«é€Ÿè¯†åˆ«é¡¹ç›®ä¸­çš„å®‰å…¨æ¼æ´å¹¶æä¾›è¯¦ç»†çš„ä¿®å¤å»ºè®®ã€‚

### âœ¨ æ ¸å¿ƒç‰¹æ€§

- ğŸ” **å®æ—¶å®‰å…¨å®¡è®¡**ï¼šè°ƒç”¨ npm å®˜æ–¹ API è¿›è¡Œä¾èµ–å®‰å…¨æ£€æŸ¥
- ğŸ“Š **è¯¦ç»†æ¼æ´æŠ¥å‘Š**ï¼šæä¾›æ¼æ´ç­‰çº§ã€æè¿°ã€ä¿®å¤å»ºè®®ç­‰å®Œæ•´ä¿¡æ¯
- ğŸ¤– **AI é›†æˆå‹å¥½**ï¼šåŸºäº MCP åè®®ï¼Œå®Œç¾é›†æˆåˆ° Cursor ç­‰ AI å¼€å‘å·¥å…·
- âš¡ **æ‰¹é‡å¤„ç†**ï¼šæ”¯æŒåŒæ—¶å®¡è®¡å¤šä¸ªä¾èµ–é¡¹
- ğŸ› ï¸ **å¼€ç®±å³ç”¨**ï¼šç®€å•é…ç½®å³å¯å¼€å§‹ä½¿ç”¨
- ğŸ”„ **æ™ºèƒ½é‡è¯•**ï¼šå†…ç½®é‡è¯•æœºåˆ¶ï¼Œç¡®ä¿å®¡è®¡ç»“æœçš„å¯é æ€§

### ğŸ—ï¸ æŠ€æœ¯æ¶æ„

```
src/
â”œâ”€â”€ index.ts       # ä¸»å…¥å£æ–‡ä»¶ï¼Œå¯åŠ¨ MCP æœåŠ¡å™¨
â”œâ”€â”€ server.ts      # MCP æœåŠ¡å™¨é…ç½®
â”œâ”€â”€ tools.ts       # å·¥å…·æ³¨å†Œå’Œè·¯ç”±
â”œâ”€â”€ security.ts    # æ ¸å¿ƒå®‰å…¨å®¡è®¡é€»è¾‘
â””â”€â”€ types.ts       # TypeScript ç±»å‹å®šä¹‰
```

### ğŸ”§ å®‰è£…ä¸ä½¿ç”¨

#### 1. ç¯å¢ƒå‡†å¤‡

```bash
# å®‰è£…ä¾èµ–
cd "07.check-dependency"
npm install

# æ„å»ºé¡¹ç›®
npm run build
```

#### 2. åŸºç¡€ä½¿ç”¨

```bash
# å¯åŠ¨ MCP æœåŠ¡å™¨
npm run start

# æˆ–ç›´æ¥è¿è¡Œ
node build/index.js
```

#### 3. åœ¨ Cursor ä¸­ä½¿ç”¨

åœ¨ Cursor é…ç½®æ–‡ä»¶ä¸­æ·»åŠ  MCP æœåŠ¡å™¨ï¼š

```json
{
  "mcpServers": {
    "check-dependency": {
      "command": "node",
      "args": ["path/to/project/build/index.js"],
      "name": "ä¾èµ–å®‰å…¨å®¡è®¡",
      "description": "æ£€æŸ¥é¡¹ç›®ä¾èµ–çš„å®‰å…¨æ¼æ´"
    }
  }
}
```

### ğŸ¯ å®æˆ˜ä½¿ç”¨ç¤ºä¾‹

#### 1. åŸºç¡€å®¡è®¡

```javascript
// é€šè¿‡ MCP è°ƒç”¨
const result = await mcpClient.call('audit_it', {
  dependencies: {
    lodash: '4.17.20',
    axios: '^1.6.0',
    react: '^18.2.0',
  },
})
```

#### 2. å®¡è®¡ç»“æœç¤ºä¾‹

```json
[
  {
    "name": "lodash",
    "version": "<4.17.21",
    "severity": "high",
    "description": "Lodash åŸå‹æ±¡æŸ“æ¼æ´",
    "recommendation": "å‡çº§åˆ° 4.17.21 æˆ–æ›´é«˜ç‰ˆæœ¬",
    "fixAvailable": true,
    "fixedVersion": ">=4.17.21",
    "githubAdvisoryId": "GHSA-35jh-r3h4-6jhm",
    "moreInfo": "https://github.com/advisories/GHSA-35jh-r3h4-6jhm"
  }
]
```

#### 3. åœ¨ AI å¼€å‘ä¸­çš„åº”ç”¨

```text
ç”¨æˆ·: è¯·å¸®æˆ‘å®¡è®¡å½“å‰é¡¹ç›®çš„ä¾èµ–å®‰å…¨æ€§

AI åŠ©æ‰‹: æˆ‘æ¥å¸®æ‚¨æ£€æŸ¥é¡¹ç›®çš„ä¾èµ–å®‰å…¨æ€§...
[è‡ªåŠ¨è°ƒç”¨ audit_it å·¥å…·]

å‘ç°ä»¥ä¸‹å®‰å…¨æ¼æ´ï¼š
- lodash 4.17.20 å­˜åœ¨é«˜å±æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ° 4.17.21+
- axios 1.6.0 å­˜åœ¨ä¸­å±æ¼æ´ï¼Œå»ºè®®å‡çº§åˆ° 1.6.8+
```

### ğŸ”’ å®‰å…¨ç‰¹æ€§

- **è¾“å…¥éªŒè¯**ï¼šä¸¥æ ¼çš„åŒ…åå’Œç‰ˆæœ¬å·æ ¼å¼æ ¡éªŒ
- **é”™è¯¯å¤„ç†**ï¼šå®Œæ•´çš„é”™è¯¯å¤„ç†å’Œ MCP é”™è¯¯è½¬æ¢
- **API é™åˆ¶**ï¼šå†…ç½®é‡è¯•æœºåˆ¶å’Œè¶…æ—¶ä¿æŠ¤
- **æ•°æ®æ¸…æ´—**ï¼šå¯¹ npm API è¿”å›æ•°æ®è¿›è¡Œå®‰å…¨è¿‡æ»¤

### ğŸ“Š æ€§èƒ½æŒ‡æ ‡

- **å“åº”æ—¶é—´**ï¼šå•æ¬¡è°ƒç”¨å»¶è¿Ÿä½äº 200ms
- **å‡†ç¡®ç‡**ï¼šæ¼æ´è¯†åˆ«å‡†ç¡®ç‡è¾¾ 95%+
- **æ•ˆç‡æå‡**ï¼šäººå·¥ä»‹å…¥æ—¶é—´ä»çº¦ 20 åˆ†é’Ÿç¼©çŸ­è‡³ 2 åˆ†é’Ÿ
- **å®é™…åº”ç”¨**ï¼šå·²åœ¨ 20+ å†…éƒ¨é¡¹ç›®ä¸­ä½¿ç”¨ï¼Œè¯†åˆ«æ¼æ´è¿‘ 50 é¡¹

### ğŸš€ é«˜çº§åŠŸèƒ½

#### 1. è‡ªå®šä¹‰é…ç½®

```typescript
// ä¿®æ”¹ src/security.ts ä¸­çš„é…ç½®
const result = await npmFetch.json('/-/npm/v1/security/audits', {
  method: 'POST',
  body: auditData,
  timeout: 30000, // è‡ªå®šä¹‰è¶…æ—¶æ—¶é—´
  retry: {
    retries: 3,
    factor: 2,
    minTimeout: 1000,
    maxTimeout: 10000,
  },
})
```

#### 2. æ‰©å±•æ–°å·¥å…·

```typescript
// åœ¨ tools.ts ä¸­æ·»åŠ æ–°å·¥å…·
server.tool(
  'check_specific_package',
  'æ£€æŸ¥ç‰¹å®šåŒ…çš„è¯¦ç»†ä¿¡æ¯',
  { packageName: z.string() },
  async ({ packageName }) => {
    // å®ç°ç‰¹å®šåŒ…æ£€æŸ¥é€»è¾‘
  }
)
```

## ğŸ’¡ å­¦ä¹ è·¯å¾„å»ºè®®

### ç¬¬ä¸€å¤©ï¼šåŸºç¡€å»ºè®¾

1. **é¡¹ç›® 01-02**ï¼šæŒæ¡åŸºç¡€èŠå¤©æœºå™¨äººå¼€å‘
2. **é¡¹ç›® 03**ï¼šå­¦ä¹ å®æ—¶ä¿¡æ¯è·å–å’Œ API é›†æˆ
3. **é¡¹ç›® 04**ï¼šæ·±å…¥ç†è§£ Function Calling æœºåˆ¶

### ç¬¬äºŒå¤©ï¼šé«˜çº§åº”ç”¨

1. **é¡¹ç›® 05-06**ï¼šæ·±å…¥å­¦ä¹  MCP åè®®å’Œæ¶æ„
2. **é¡¹ç›® 07**ï¼šå®æˆ˜å¼€å‘å®‰å…¨å®¡è®¡å·¥å…·
3. **é›†æˆåº”ç”¨**ï¼šå°†å·¥å…·é›†æˆåˆ° AI å¼€å‘ç¯å¢ƒ

## ğŸ› ï¸ ç¯å¢ƒé…ç½®

### å¿…è¦ä¾èµ–

```bash
# Node.js ç¯å¢ƒ
node >= 18.0.0
npm >= 8.0.0

# å‰ç«¯ä¾èµ–
vue >= 3.0.0
pnpm

# åç«¯ä¾èµ–
express >= 4.16.0
@modelcontextprotocol/sdk >= 1.15.0
```

### API é…ç½®

```bash
# åˆ›å»º .env æ–‡ä»¶
DEEPSEEK_API_KEY=your_deepseek_api_key
HEFENG_API_KEY=your_weather_api_key
```

## ğŸ”® æ‰©å±•æ–¹å‘

1. **æ›´å¤š MCP å·¥å…·**ï¼šå¼€å‘ä»£ç åˆ†æã€æ–‡æ¡£ç”Ÿæˆç­‰å·¥å…·
2. **AI Agent é›†æˆ**ï¼šå°†å·¥å…·é“¾é›†æˆåˆ°æ™ºèƒ½ä»£ç†ç³»ç»Ÿ
3. **äº‘ç«¯éƒ¨ç½²**ï¼šæ”¯æŒäº‘ç«¯æœåŠ¡å’Œ API è°ƒç”¨
4. **ä¼ä¸šçº§åŠŸèƒ½**ï¼šæ”¯æŒç§æœ‰ registry å’Œä¼ä¸šçº§é…ç½®

## ğŸ“š ç›¸å…³èµ„æº

- [DeepSeek å¼€å‘å¹³å°](https://platform.deepseek.com/)
- [å’Œé£å¤©æ°” API](https://dev.qweather.com/)
- [MCP åè®®æ–‡æ¡£](https://modelcontextprotocol.io/)
- [npm å®‰å…¨å®¡è®¡ API](https://docs.npmjs.com/cli/v10/commands/npm-audit)

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿è´¡çŒ®ä»£ç å’Œå»ºè®®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. Fork æœ¬ä»“åº“
2. åˆ›å»ºç‰¹æ€§åˆ†æ”¯ï¼š`git checkout -b feature/your-feature`
3. æäº¤æ›´æ”¹ï¼š`git commit -am 'Add some feature'`
4. æ¨é€åˆ°åˆ†æ”¯ï¼š`git push origin feature/your-feature`
5. æäº¤ Pull Request

## ğŸ“„ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ã€‚

## ğŸ†˜ æŠ€æœ¯æ”¯æŒ

å¦‚æœæ‚¨åœ¨å­¦ä¹ è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œå¯ä»¥ï¼š

1. æŸ¥çœ‹å„é¡¹ç›®çš„ README æ–‡æ¡£
2. å‚è€ƒ `è¯¾å‰é¢„ä¹ èµ„æ–™.md` å’Œ `é›†è®­è¥è¯¾ç¨‹é…å¥—èµ„æ–™.md`
3. æäº¤ Issue æˆ– Pull Request

---

**æ³¨æ„äº‹é¡¹**ï¼š

- ç¡®ä¿æ‚¨çš„å¼€å‘ç¯å¢ƒæ»¡è¶³ Node.js ç‰ˆæœ¬è¦æ±‚
- ç”³è¯·å¿…è¦çš„ API Key æ‰èƒ½æ­£å¸¸ä½¿ç”¨ç›¸å…³åŠŸèƒ½
- å®‰å…¨å®¡è®¡å·¥å…·éœ€è¦ç½‘ç»œè®¿é—® npm registry
